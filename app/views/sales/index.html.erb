<div class="container my-5">
  <h1>Order history</h1>
  <div class="accordion accordion-flush" id="accordionFlushExample">
    <% @sales.each do |sale| %>
      <% if sale.chillis.all.count > 0 %>
        <div class="accordion-item">
          <h2 class="accordion-header" id="flush-heading<%= sale.id %>">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse<%= sale.id %>" aria-expanded="false" aria-controls="flush-collapse<%= sale.id %>">
              Order number #<%= sale.id %>
            </button>
          </h2>
          <div id="flush-collapse<%= sale.id %>" class="accordion-collapse collapse" aria-labelledby="flush-heading<%= sale.id %>" data-bs-parent="#accordionFlushExample">
            <div class="accordion-body d-flex justify-content-center">
              <div class="basket-container gradient-background d-flex flex-column align-items-center pt-3 w-50">
                <% sale.chillis.all.each do |chilli| %>
                  <div class="w-75">
                    <%= link_to chilli, class: "card-link col-8 col-xl-3 nopadding m-3" do %>
                      <div class="basket-card-product d-flex justify-content-between align-items-start">
                        <%= cl_image_tag chilli.photos.first.key %>
                        <div class="d-flex justify-content-between align-items-start w-100 ps-3">
                          <h2><%= chilli.variety %></h2>
                          <h2>£<%= number_with_precision(chilli.price, precision: 2) %></h2>
                        </div>
                      </div>
                    <% end %>
                  </div>
                <% end %>
                <hr class="hr-black">
                <div class="d-flex justify-content-between w-75">
                  <p>Shipping</p>
                  <p><%# TO DO %>£3.00</p>
                </div>
                <div class="d-flex justify-content-between w-75 pb-3">
                  <h2>TOTAL</h2>
                  <h2>£<%= number_with_precision(sale.chillis.all.map(&:price).reduce(:+) + 3, precision: 2) %></h2>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
